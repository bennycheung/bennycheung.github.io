---
layout: default
---

<br />
<br />
<br />
<br />

<div class="container" role="main" style="font-family: Helvetica;">

  <!-- Featured Posts Section -->
  {% assign featured = site.posts | where: "featured", true | sort: "featured_order" %}
  {% if featured.size > 0 %}
    {% assign hero = featured | first %}

    <!-- Hero Featured Post -->
    <div class="featured-hero">
      <div class="card">
        <a href="{{ hero.url }}">
          {% if hero.images.animated-cover %}
            <img class="card-img" src="/{{ hero.images.animated-cover }}" alt="{{ hero.title }}">
          {% elsif hero.images.cover %}
            {% if hero.images.cover contains '.mp4' or hero.images.cover contains '.webm' %}
              <video class="card-img" autoplay muted loop playsinline>
                <source src="/{{ hero.images.cover }}" type="video/{% if hero.images.cover contains '.webm' %}webm{% else %}mp4{% endif %}">
              </video>
            {% else %}
              <img class="card-img" src="/{{ hero.images.cover }}" alt="{{ hero.title }}">
            {% endif %}
          {% elsif hero.image %}
            <img class="card-img" src="/{{ hero.image }}" alt="{{ hero.title }}">
          {% endif %}
        </a>
        <div class="card-body">
          <span class="label label-primary">Featured</span>
          <h1 class="card-title">
            <a href="{{ hero.url }}">{{ hero.title }}</a>
          </h1>
          <p class="card-meta">
            {{ hero.date | date: "%b %d, %Y" }}
            {% assign words = hero.content | number_of_words %}
            {% assign reading_time = words | divided_by: 200 %}
            {% if reading_time < 1 %}{% assign reading_time = 1 %}{% endif %}
            &bull; {{ reading_time }} min read
          </p>
          <p class="card-text">{{ hero.excerpt | strip_html | truncate: 250 }}</p>
        </div>
      </div>
    </div>

    <!-- Secondary Featured Posts (2 columns) -->
    {% if featured.size > 1 %}
    <div class="row featured-secondary">
      {% for post in featured offset:1 %}
      <div class="col-sm-6">
        <div class="card">
          <a href="{{ post.url }}">
            {% if post.images.animated-cover %}
              <img class="card-img" src="/{{ post.images.animated-cover }}" alt="{{ post.title }}" loading="lazy">
            {% elsif post.images.cover %}
              {% if post.images.cover contains '.mp4' or post.images.cover contains '.webm' %}
                <video class="card-img" autoplay muted loop playsinline preload="metadata">
                  <source src="/{{ post.images.cover }}" type="video/{% if post.images.cover contains '.webm' %}webm{% else %}mp4{% endif %}">
                </video>
              {% else %}
                <img class="card-img" src="/{{ post.images.cover }}" alt="{{ post.title }}" loading="lazy">
              {% endif %}
            {% elsif post.image %}
              <img class="card-img" src="/{{ post.image }}" alt="{{ post.title }}" loading="lazy">
            {% endif %}
          </a>
          <div class="card-body">
            <span class="label label-primary">Featured</span>
            <h3 class="card-title">
              <a href="{{ post.url }}">{{ post.title }}</a>
            </h3>
            <p class="card-meta">
              {{ post.date | date: "%b %d, %Y" }}
              {% assign words = post.content | number_of_words %}
              {% assign reading_time = words | divided_by: 200 %}
              {% if reading_time < 1 %}{% assign reading_time = 1 %}{% endif %}
              &bull; {{ reading_time }} min read
            </p>
            <p class="card-text">{{ post.excerpt | strip_html | truncate: 280 }}</p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% endif %}
  {% endif %}

  <!-- Recent Posts Section with Pagination -->
  <div class="recent-posts">
    <h2><i class="fa fa-clock-o"></i> Recent Posts</h2>

    <div class="posts-carousel">
      {% assign post_count = 0 %}
      {% assign page_num = 1 %}
      {% for post in site.posts %}
        {% if post.category == "post" and post.featured != true %}
          {% assign position_in_page = post_count | modulo: 6 %}
          {% if position_in_page == 0 %}
            {% if post_count > 0 %}
              </div></div>
            {% endif %}
            <div class="posts-page{% if post_count == 0 %} active{% endif %}" data-page="{{ page_num }}">
            <div class="row">
            {% assign page_num = page_num | plus: 1 %}
          {% endif %}
          <div class="col-sm-4">
            <div class="post-card">
              <a href="{{ post.url }}">
                <!-- Non-featured posts use their image: frontmatter -->
                {% if post.image %}
                  <img class="card-img" src="/{{ post.image }}" alt="{{ post.title }}" loading="lazy">
                {% else %}
                  <img class="card-img" src="/images/default-cover.jpg" alt="{{ post.title }}" loading="lazy">
                {% endif %}
              </a>
              <div class="card-body">
                <h4 class="card-title">
                  <a href="{{ post.url }}">{{ post.title }}</a>
                </h4>
                <p class="card-meta">
                  {{ post.date | date: "%b %d, %Y" }}
                  {% assign words = post.content | number_of_words %}
                  {% assign reading_time = words | divided_by: 200 %}
                  {% if reading_time < 1 %}{% assign reading_time = 1 %}{% endif %}
                  &bull; {{ reading_time }} min read
                </p>
                <p class="card-excerpt">{{ post.excerpt | strip_html | truncate: 100 }}</p>
              </div>
            </div>
          </div>
          {% assign post_count = post_count | plus: 1 %}
        {% endif %}
      {% endfor %}
      {% if post_count > 0 %}
        </div></div>
      {% endif %}
    </div>

    <!-- Pagination Controls -->
    <div class="posts-pagination">
      <button class="page-btn prev-btn" disabled><i class="fa fa-chevron-left"></i></button>
      <div class="page-dots">
        {% assign total_pages = post_count | divided_by: 6 %}
        {% assign remainder = post_count | modulo: 6 %}
        {% if remainder > 0 %}{% assign total_pages = total_pages | plus: 1 %}{% endif %}
        {% for i in (1..total_pages) %}
          <span class="page-dot{% if i == 1 %} active{% endif %}" data-page="{{ i }}"></span>
        {% endfor %}
      </div>
      <button class="page-btn next-btn"><i class="fa fa-chevron-right"></i></button>
    </div>
  </div>

  <!-- Topic Cloud Section - D3 Word Cloud -->
  <div class="topic-cloud-section">
    <h2><i class="fa fa-tags"></i> Popular Topics</h2>
    <div class="topic-cloud-container">
      <div id="topic-word-cloud"></div>
    </div>
  </div>

  <!-- Tag Data for Word Cloud -->
  <script id="home-tag-data" type="application/json">
  [{% assign first_item = true %}{% for tag in site.tags %}{% if tag[1].size >= 2 %}{% unless first_item %},{% endunless %}{"text":"{{ tag[0] | escape }}","size":{{ tag[1].size }}}{% assign first_item = false %}{% endif %}{% endfor %}]
  </script>

  <!-- Navigation Buttons -->
  <div class="landing-nav">
    <a href="/archives/" class="btn btn-default btn-lg">
      <i class="fa fa-archive"></i> View All Posts
    </a>
    <a href="/tags/" class="btn btn-default btn-lg">
      <i class="fa fa-tags"></i> Browse by Tag
    </a>
    <a href="/series/" class="btn btn-default btn-lg">
      <i class="fa fa-bookmark"></i> View All Series
    </a>
  </div>

  <!-- Social Follow Links -->
  {% include social_follow.html %}

</div>

<style>
/* Topic Word Cloud for Home Page */
.topic-cloud-section {
  margin: 40px 0;
  text-align: center;
}

.topic-cloud-section h2 {
  margin-bottom: 20px;
  color: #333;
}

.topic-cloud-container {
  max-width: 800px;
  margin: 0 auto;
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  border-radius: 16px;
  padding: 15px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
}

#topic-word-cloud {
  width: 100%;
  min-height: 280px;
}

#topic-word-cloud text {
  cursor: pointer;
  font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
}

/* Dark Mode */
html.dark-mode .topic-cloud-section h2 {
  color: #e2e8f0;
}

html.dark-mode .topic-cloud-container {
  background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}

/* Responsive */
@media (max-width: 768px) {
  .topic-cloud-container {
    padding: 10px;
    border-radius: 12px;
  }
  #topic-word-cloud {
    min-height: 220px;
  }
}
</style>

<!-- D3.js Word Cloud for Home Page -->
<script src="/js/d3/d3.v3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-cloud/1.2.5/d3.layout.cloud.min.js"></script>
<script>
window.addEventListener('load', function() {
  var dataEl = document.getElementById('home-tag-data');
  if (!dataEl) return;

  var tagData = JSON.parse(dataEl.textContent.trim());
  if (!tagData || tagData.length === 0) return;

  // Filter out any null entries from trailing commas
  tagData = tagData.filter(function(d) { return d && d.text; });

  var maxSize = d3.max(tagData, function(d) { return d.size; });
  var minSize = d3.min(tagData, function(d) { return d.size; });

  var colorScale = d3.scale.linear()
    .domain([minSize, (minSize + maxSize) / 2, maxSize])
    .range(['#6c5ce7', '#00b894', '#e17055']);

  var fontScale = d3.scale.linear()
    .domain([minSize, maxSize])
    .range([14, 48]);

  var container = document.getElementById('topic-word-cloud');
  var width = container.offsetWidth || 700;
  var height = 280;

  function initCloud() {
    container.innerHTML = '';
    width = container.offsetWidth || 700;

    var layout = d3.layout.cloud()
      .size([width, height])
      .words(tagData.map(function(d) {
        return {
          text: d.text,
          size: fontScale(d.size),
          count: d.size,
          color: colorScale(d.size)
        };
      }))
      .padding(5)
      .rotate(function() { return ~~(Math.random() * 3) * 30 - 30; })
      .font("'Segoe UI', 'Helvetica Neue', Arial, sans-serif")
      .fontSize(function(d) { return d.size; })
      .spiral('archimedean')
      .on("end", draw);

    layout.start();
  }

  function draw(words) {
    if (!words || words.length === 0) return;

    var svg = d3.select("#topic-word-cloud")
      .append("svg")
      .attr("width", width)
      .attr("height", height)
      .attr("viewBox", "0 0 " + width + " " + height)
      .attr("preserveAspectRatio", "xMidYMid meet")
      .append("g")
      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

    svg.selectAll("text")
      .data(words)
      .enter().append("text")
      .style("font-size", function(d) { return d.size + "px"; })
      .style("font-family", "'Segoe UI', 'Helvetica Neue', Arial, sans-serif")
      .style("font-weight", function(d) { return d.size > 30 ? "600" : "400"; })
      .style("fill", function(d) { return d.color; })
      .attr("text-anchor", "middle")
      .attr("transform", function(d) {
        return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
      })
      .text(function(d) { return d.text; })
      .on("mouseover", function(d) {
        d3.select(this)
          .style("opacity", 0.7)
          .style("filter", "drop-shadow(0 2px 6px rgba(0,0,0,0.4))");
      })
      .on("mouseout", function(d) {
        d3.select(this)
          .style("opacity", 1)
          .style("filter", "none");
      })
      .on("click", function(d) {
        var slug = d.text.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
        window.location.href = '/tags/#' + slug;
      });
  }

  initCloud();

  var resizeTimeout;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(initCloud, 300);
  });
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js"></script>
<script>L2Dwidget.init({"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script>
{% include cat_dialog.html %}
